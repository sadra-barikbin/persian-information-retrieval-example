در همان زمان، خبر شورش جدیدی از سوی والی زنجان به آقامحمدخان رسید و او را مجبور ساخت که مجدداً به آن سمت بازگردد. چون خان قاجار به زنجان رسید، والی شهر درخواست بخشش کرد و آقامحمدخان نیز وی را بخشید. او سپس از زنجان راه تهران در پیش گرفت و مدتی در آن شهر ماند اما در گیلان اتفاقاتی در حال رخ دادن بود که توجه او را می‌طلبید. هدایت‌الله‌خان، خان سابق گیلان، ظاهراً با حمایت روس‌ها، به آن ولایت بازگشته بود. با اتحاد هدایت‌الله‌خان و روسیه آقامحمدخان تمام سواحل شمالی ایران را در خطر می‌دید. بازگشت هدایت‌الله‌خان به رشت برای آقامحمدخان دلیل کافی برای لشکرکشی مجدد به گیلان بود؛ حال آنکه او با روس‌ها نیز همکاری می‌کرد.

از بخت خوب آقامحمدخان، هدایت‌الله‌خان به اندازه کافی در میان بزرگان گیلان دشمن داشت و ورود دوم او در سال ۱۷۸۶ م/۱۲۰۰ ه‍.ق به گیلان، مانند ورود اولش، نیاز به درگیری‌های بزرگی نداشت. در راه رشت، مهدی‌بیگ خلعتبری، حاکم تنکابن که از سوی کریم‌خان به آن جایگاه منصوب شده بود، به استقبالش آمد. کنسول روس در رشت که هدایت‌الله‌خان را شکست‌خورده می‌دید هم با ارسال سلاح، جانب آقامحمدخان را گرفت. هدایت‌الله‌خان که شانسی برای پیروزی نمی‌دید، با یک کشتی روسی از انزلی به سمت شروان یا لنکران راهی شد اما در راه توسط آقاعلی، حاکم شفت، دستگیر شد. او نیز به انتقام کشتار خانواده‌اش، هدایت‌الله‌خان را کشت. گیلان باز هم به قلمروی آقامحمدخان بازگشت. روس‌ها در آن ولایت، به خصوص در رشت و انزلی، قرارگاه‌هایی برپا کرده بودند که محمدخان به آن بدبین بود. به علاوه، او اخیراً خیانت هیئت روس به هدایت‌الله‌خان را دیده بود اما می‌دانست که دوستی روس‌ها می‌تواند روزی برایش سودمند باشد. همچنین، در اقامتگاه هدایت‌الله‌خان، مقدار زیادی طلا وجود داشت که به دست آقامحمدخان افتاد. او از آن طلاها برای جلب وفاداری مردانش استفاده کرد.