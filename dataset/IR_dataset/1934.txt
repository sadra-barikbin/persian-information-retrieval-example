پس از مأموریّت یافتن گرگین خان به حکومت هرات، به علّت ظلمش نسبت به مردم، طایفه افغانی غلجائی را که در حدود قندهار ساکن بودند به ستوه آورد. آن‌ها پی در پی از ظلم او به شاه سلطان حسین شکایت کردند، امّا چون دسترسی به شاه که بیشتر اوقات با زنان و خواجه سرایان معاشر بود، امکان نداشت و برخی خواصّ نیز نمی‌گذاشتند تظلم اهل قندهار به شاه برسد، میرویس غلجائی، کلانتر قندهار، شخصاً به اصفهان آمد تا شاه را از حقایق مطلع کند؛ ولی با تحریک گرگین خان و اعوان گرجی او، نتوانست شاه را ملاقات کند. او مدّتی در اصفهان بازداشت شد تا اجازه سفر مکّه یافت و به قصد زیارت، از اصفهان بیرون رفت.

پس از مراجعت میرویس به اصفهان، اوضاع دربار صفوی را آشفته تر از سابق دید. عدّه‌ای از تجّار و فرستادگان پطر کبیر، میرویس را به شوراندن افغانی‌های قندهار تحریک کردند. میرویس شایعه کرد که پطر، عازم تسخیر گرجستان و ارمنستان است و گرگین خان با او همدست شده. با این تدبیر، موفّق شد دوباره کلانتر قندهار شود و مواظب حرکات گرگین خان باشد.

پس از بازگشت میرویس به قندهار، گرگین خان، او را تحت فشار قرار داد و دخترش را از او خواست. میرویس دختر دیگری را به نام دختر خود پیش گرگین فرستاد و تا حدّی دل او را نسبت به خود نرم نمود. در سال ۱۱۲۱ ه‍.ق او را به باغی دعوت کرد و همان‌جا او را کشت. سپس با پوشیدن لباس او، توانست وارد قلعه شده و همه اطرافیان او را بکشد. پس از این موفقیت، غلجائیان را به کمک فتوایی که از علمای سنّت، مبنی بر وجوب جنگ با شیعه گرفته بود علیه پادشاه ایران برانگیخت. در این کار، اورنگ زیب پادشاه هند نیز او را تحریک کرد.

پس از رسیدن خبر قتل گرگین، شاه سلطان حسین برادرزاده او کیخسرو خان را برای سرکوبی میرویس فرستاد. او قندهار را محاصره کرد و یک سال نیز آن جا را در محاصره داشت. با این که محصورین تسلیم شدند ولی او از نادانی به آن‌ها جواب مساعد نداد تا این که با وجود داشتن بیست و پنج هزار سرباز شکست خورد و کشته شد. این اتفاق، اعتماد به نفس میرویس و غلجائیان را افزایش داد. به‌طوری‌که سرداران دیگر صفوی را هم که به تسخیر قندهار آمدند، مغلوب کردند.