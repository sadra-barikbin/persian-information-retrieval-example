حضور لطفعلی‌خان زند در کرمان به آقامحمدخان قاجار این فرصت را داد که با آسودگی خاطر، به سمت شمال غرب ایران لشکر بکشد و آذربایجان را تحت سلطه خود بیاورد. او فتحعلی را به عنوان بیگلربیگی عراق عجم منصوب کرد و در بهار ۱۷۹۱ م. به سمت آذربایجان راهی شد. در مسیر، او در طارم توقف کرد. وی سلیمان‌خان قوانلو که از نزدیکان مورد اعتمادش بود را با مأموریت مطیع کردن تالش به آن سمت راهی کرد. آقامحمدخان خود به سمت سراب لشکر کشید. ایلات شقاقی سراب سر از اطاعت او پیچیده بودند و وی مجدداً آنان را تابع کرد. سپس راهی اردبیل شد و آنجا از آرامگاه شیخ صفی‌الدین اردبیلی زیارت کرد. سپس به راهش ادامه داد و در قراچه‌داغ مخالفانش را سرکوب کرد. در نهایت حسین‌قلی، رهبر ایل دنبلی از قبایل کرد را به عنوان حاکم تبریز و خوی منصوب کرد.

همزمان با حضور آقامحمدخان در شمال غرب ایران، اتفاقاتی در جنوب غرب و مرکز ایران در جریان بود که توجه او را می‌طلبید. لطفعلی‌خان، پس از عدم موفقیت در سفر کرمان، به شیراز بازگشته بود و با سپاه خود به قمشه، محل اردوی فتحعلی، لشکر کشیده بود و به سمت اصفهان پیشروی کرده بود. همچنین، حاجی ابراهیم‌خان شیرازی، کلانتر فارس، از نبود لطفعلی‌خان استفاده کرده بود و در شیراز سر به شورش برداشته بود. لطفعلی‌خان در کازرون مشغول تجدید قوا بود تا بتواند شهر را پس بگیرد. ابراهیم کلانتر در ابتدا ظاهراً تنها با هدف تحت کنترل گرفتن شیراز دروازه‌ها را بر لطفعلی‌خان بست اما تلاش خان زند برای پس گرفتن شهر باعث شد که او از آقامحمدخان قاجار یاری بخواهد. حاج ابراهیم کلانتر در نامه‌ای از آقامحمدخان تقاضا کرد که نماینده‌ای به شیراز بفرستد تا شهر را در دست و خزاین لطفعلی‌خان را تحویل بگیرد. آقامحمدخان در حال بازگشت از آذربایجان بود که پیام کلانتر را دریافت کرد. این یک فرصت پیش‌بینی نشده برای او بود زیرا می‌توانست با تسخیر پایتخت زندیه، هم فارس را فتح کند و هم سلسله زند را نابود سازد. او بدون معطلی پیشنهاد حاج ابراهیم را پذیرفت و او را به عنوان بیگلربیگی فارس منصوب کرد. او میرزا رضاقلی نوایی منشی الممالک را مأمور کرد که به سمت اصفهان که فتحعلی در آنجا بود، رفته و از آنجا به اتفاق مصطفی‌خان قاجار با سه هزار سپاهی به سمت شیراز رود؛ دارایی زندیان را تصاحب کند و خانواده لطفعلی‌خان را به تهران بیاورد. آقامحمدخان همچنین به جای حاج ابراهیم کلانتر که بیگلربیگی فارس شده بود، محمدزمان شیرازی، برادر حاج ابراهیم را به کلانتری شیراز منصوب کرد.