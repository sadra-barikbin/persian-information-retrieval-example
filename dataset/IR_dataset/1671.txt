همزمان با سفر لطفعلی‌خان به کرمان، در شیراز توطئه‌ای در حال شکل گرفتن بود که ظاهراً حاج ابراهیم کلانتر پشت پرده آن را پیش می‌برد. از مهم‌ترین دلایل این مسئله، دشمنی سرداران لطفعلی‌خان با حاج ابراهیم بود که پیش خان زند بدگویی کلانتر را می‌کردند. بدین ترتیب میان آن دو بدگمانی شدیدی ایجاد شده بود. میرزا حسین وزیر که به وفا معروف بود، این مسئله را چنین برای سر هارفورد جونز، افسر انگلیسی کمپانی هند شرقی که لطفعلی‌خان را از نزدیک می‌شناخت، نقل کرده‌است که «مدتی است اتحادی بین حاجی ابراهیم و برادرش و چند تن دیگر از خان‌های دشتستان و گرمسیر و به ویژه رضاقلی‌خان کازرونی و شیخ نصر لاری شکل گرفته‌است.» هدف این اتحاد از بین بردن لطفعلی‌خان زند و ایجاد حکومتی جدید عنوان شده‌است. نقشه این بود که پس از در اختیار گرفتن شیراز توسط حاج ابراهیم، لطفعلی‌خان را در چادرش سر به نیست کنند.

وفا به سر هارفورد جونز گفته بود که «عوامل حاج ابراهیم کلانتر مرا به اشاره و در لفافه از این مسئله آگاه ساختند و من تلاش نمودم تا لطفعلی‌خان متوجه این خطر شود. پانزده روز پیش از اینکه قشون از شیراز به سمت اصفهان حرکت کند مسئله را با لطفعلی‌خان مطرح کردم و به زانو افتادم و از او خواستم تا حاج ابراهیم را بازداشت کند اما او با بی‌اعتنایی گفت: وقت حرکت قشون نزدیک است و اگر حالا او را بازداشت کنم همه چیز مختل می‌شود. پس از بازگشت مسئله را بررسی خواهم کرد.» لطفعلی‌خان همچنین برخوردارخان را به جهت اطمینان به حفاظت قلعه شیراز برگماشت که البته وفا با این تصمیم مخالف بود. او از خان زند تقاضا کرد که خودش را به این کار منصوب کند که لطفعلی‌خان زند پاسخ داد که «من به شما نیاز دارم.»

پس از اینکه لطفعلی‌خان در اوایل سال ۱۲۰۵ هـ.ق. به سمت اصفهان روانه شد، اداره امور شیراز را به حاج ابراهیم سپرد، برخوردارخان را مسئول حفاظت از برج و باروی شهر کرد و نگهبانی از ارگ و حرمسرا را نیز به محمدعلی‌خان واگذاشته شد. خان زند همچنین برادر حاج ابراهیم را به فرماندهی سپاه خود برگزید و پسر کلانتر که میرزا محمد نام داشت را به ملتزمی رکاب خود منصوب کرد تا از حاج ابراهیم گروگان‌هایی داشته باشد. دیگر در این زمان بی‌اعتمادی میان لطفعلی‌خان زند و حاج ابراهیم کلانتر آشکار بود و هر دو از نیت هم آگاهی داشتند.