با سقوط صفویه پطر اول به ایران لشکر کشید و قشون روسیه در سپتامبر ۱۷۲۲ میلادی در بند و در ۱۷۲۳ باکو را به اشغال خود درآوردند. شاه تهماسب دوم مجبور شد در پی اتحاد با روس‌ها باشد. طبق قراردادی که در سپتامبر ۱۷۲۳ تنظیم گردید پطر اول به شاه وعده داد که او را در مبارزه با افغانان یاری دهد؛ و شاه تهماسب نیز دربند و باکو را جز قلمرو روسیه شناخت و گیلان را نیز در اختیار آن‌ها گذاشت.

اشرف شاه ارتشی را به مقابل روس‌های تزاری فرستاد. تا جلوی اشغال روس‌ها را بگیرد ولی او نتوانست روس‌ها را وادار به عقب‌نشینی کند. دست‌آورد اشرف در جنگ با روس‌ها این بود که جلوی اشغال مناطق بیشتر گرفته شد.
دولت عثمانی، تفلیس، عراق عجم و قسمت بزرگی از آذربایجان را تحت تصرف خویش درآورده بود. اشرف می‌خواست با دولت عثمانی عهدنامه‌ای منعقد سازد و به واسطهٔ اشتراک مذهب تسنن، اراضی ضبط‌شدهٔ روزگار دولت صفوی را مسترد دارد، اما به آرزوی خویش نایل نگشت و در نتیجه جنگ ادامه یافت؛ و در چندین مرحله نیروهای افغان و عثمانی در مقابل هم صف‌آرایی کردند. نتیجه این جنگ‌ها به سود افغان‌ها بود. در ابتدا اشرف ریش‌سفیدانی به سمت لشکر عثمانی فرستاد تا پیام صلح را به عثمانی‌ها بدهند ولی عثمانی‌ها نپزیرفتند. در این میان ۲۰٬۰۰۰ هزار نفر از ارتش عثمانی جدا شدند و به افغان‌ها پیوستند. آن‌ها از طایفهٔ کرد بودند که احساس هم‌دین بودن با افغان‌ها، آن‌ها را از ارتش عثمانی جدا کرد و به ارتش افغان‌ها پیوستند. بدین ترتیب جنگ آغاز شد. نتیجهٔ جنگ‌ها شکست کامل ارتش عثمانی بود. سرانجام در تاریخ ۱۱۴۰ ه‍.ق دولت‌های عثمانی و روسیه پادشاهی وی را در ایران تصدیق کردند.

سرانجام اشرف افغان پس از شکست‌های متمادی از نادر قُلی‌خان(معروف به نادرشاه افشار
) به سوی بلوچستان عقب‌نشینی کرد و در آنجا به دست سلطان علی محجوب یکی از فرماندهان مورد اعتماد نادر قلی‌خان و شاه طهماسب دوم کشته شد و سرش را همراه با یک الماس برای شاه طهماسب دوم فرستادند.
شاه طهماسب هم در سال ۱۷۲۹ میلادی توسط نادر قلی‌خان از سلطنت کنار گذاشته می شود و در ۱۱ فوریه ۱۷۴۰ توسط فرزند نادرشاه افشار به قتل می رسد. 

روایت دیگری دربارهٔ مرگ اشرف می‌گوید در ماه مارس ۱۷۳۰ به‌ضرب گلولهٔ یکی از گماشتگان حسین هوتکی به نام ابراهیم به قتل رسید؛ و گویا به انتقام مرگ محمود، برادر حسین هوتکی کشته شد.