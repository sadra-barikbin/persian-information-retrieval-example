ظاهراً نبردِ نادر با ابدالی‌های افغان در هرات، ذهنیتِ اشرف را — که پیش از آن تهماسب را خطری نمی‌پنداشت — تغییر داد. او در ۱۳ مُحَرَّم ۱۱۴۲ ه‍.ق/اوت ۱۷۲۹ م، با لشکری ۳۰٬۰۰۰ نفری برای حمله به نادر و تهماسب از اصفهان به سوی مشهد حرکت کرد. برخلاف تصورش — که احتمالاً طولانی شدنِ درگیریِ نادر با ابدالی‌ها بوده و می‌خواسته‌است تا نادر را با تصرفِ مشهد غافلگیر کند — سرعتِ پیروزیِ نادر در نبرد با ابدالی‌ها اهداف او را برهم زد. سپاهِ اشرف ابتدا به شمالِ تهران آورده شد و در طول مسیر، دسته‌های پراکنده و سربازانِ مستقر در پادگان‌ها را به خدمت گرفت و سپس در راستای کوهپایه‌های جنوبیِ البرز به سوی خراسان حرکت کرد و در اواخرِ تابستانِ همان سال، سمنان را با نزدیک ۴۰٬۰۰۰ سرباز محاصره کرد. از آن سو، نادر در ۱۸ صفر ۱۱۴۲ ه‍.ق/۱۲ سپتامبر ۱۷۲۹ م، همراه با تهماسب از راه نیشابور و سبزوار برای نبرد با افغان‌ها حرکت کرد. سپاه نادر را حدود ۲۵۰۰۰ نفر تخمین زده‌اند. صبح روز ۶ ربیع‌الاول ۱۱۴۲ ه‍.ق/۲۹ سپتامبر ۱۷۲۹ م، در نزدیکیِ مهماندوست دامغان نبرد آغاز شد و سرانجام سپاهیانِ افغان شکست خوردند و عقب‌نشینی کردند. پس از نبرد مجدداً میانِ نادر و تهماسب بحثی درگرفت و ظاهراً علتش اصرارِ تهماسب برای حرکتِ سریع‌تر به سوی اصفهان بوده اما نادر دلایلی آورده و مصلحت را بازگشت به مشهد و تجدیدِ قوا و رفتن به اصفهان در سالِ بعد دانسته‌است. سرانجام برای نخستین بار تهماسب توانست نادر را وادار به پذیرشِ نظرِ خویش کند. اشرف به ورامین عقب‌نشینی، و در آنجا نیروهای بیشتری را جذب کرد. مجدداً در شرقِ ورامین، نبردِ دوم درگرفت و بار دیگر سپاهِ افغان شکست خوردند و به اصفهان عقب‌نشینی کردند. اشرف در اصفهان ۳۰۰۰ نفر از ساکنان و روحانیانِ برجسته را قتل‌عام کرد تا شورشی صورت نگیرد. سربازانِ اشرف نیز بازار را غارت کردند و آتش زدند. اشرف پس از دریافتِ کمک از احمدپاشا، از اصفهان بیرون آمد تا برای سومین بار به نبردِ نادر برود و در ربیع‌الثّانی ۱۱۴۲ ه‍.ق/اکتبر ۱۷۲۹ م، در حوالیِ مورچه خورت مستقر شد. نادر تهماسب را در تهران باقی گذاشت و به سوی جنوب حرکت کرد. صبحِ ۲۰ ربیع‌الثانی ۱۱۴۲ ه‍.ق/۱۳ نوامبر ۱۷۲۹ م، نادر به سوی اصفهان پیشروی کرد. سرانجام برای سومین بار نبرد آغاز شد و باز هم سپاه افغان شکست خوردند و فرار کردند. اشرف غروب همان روز سریعاً به اصفهان برگشت و تا جایی که توانست اشیاء قیمتی را گرد آورد و همراه با زنان و اعضای خانوادهٔ صفوی، صبح روز بعد به سوی شیراز حرکت، نادر در ۲۳ ربیع‌الثانی ۱۱۴۲ ه‍.ق/۱۶ نوامبر ۱۷۲۹ م، با سپاه خود وارد اصفهان شد. سربازانِ نادر به‌سرعت شهرِ غارت‌شده و اغتشاش‌زده را تحت کنترل درآوردند. به‌دستورِ نادر باقیِ افغان‌هایی را که مخفی شده بودند، یافتند و اعدام کردند جز تعدادِ اندکی که در مدتِ اشغال، با انسانیت رفتار کرده بودند. در ۱۸ جمادی‌الاول ۱۱۴۲ ه‍.ق/۹ دسامبر ۱۷۲۹ م، نادر رسماً از تهماسب در بیرون از شهر استقبال کرد. با حضورِ نادر در کنترلِ واقعیِ امور، تهماسب نهایتاً در جمادی‌الاول ۱۱۴۲ ه‍.ق/دسامبر ۱۷۲۹ م در اصفهان مستقر شد، که نشانگرِ پایانِ واقعیِ حکومتِ افغان‌ها در ایران بود؛ اگرچه وی به‌وضوح در رنج و عذاب بود چراکه نادر بی رضایتِ قبلیِ شاه با یکی از خواهرانش، راضیه بِیْگُم ازدواج کرد. شوالیه دوگاردان نادر را در این هنگام در سن چهل سالگی می‌داند اما اگر تولدش در ۱۶۹۸ م پنداشته شود، او ۳۱ سال داشته‌است. در پی شکستِ اشرف، بسیاری از سربازانِ افغان به سپاهِ نادر پیوستند و در بسیاری از نبردهای بعدی کمک فراوانی کردند.

تهماسب پس از استقرار در اصفهان از نادر خواست اشرف را تعقیب کند تا هم کار افغان‌ها تمام شود و هم اعضای خانوادهٔ صفوی از چنگ اشرف آزاد شوند. نادر ابتدا نپذیرفت که احتمالاً به‌خاطر این بود تا پاداشِ بازپس‌گیریِ اصفهان را کاملاً دریافت کند. سرانجام نادر موافقت کرد در ازای حاکمیتش بر خراسان، مازندران و کرمان و تأمین هزینهٔ سپاه از طریق مالیات در سراسرِ کشور و نیز حقِّ نهادنِ جِقّه بر سر، به تعقیبِ اشرف برود. برای ضمانتِ دوامِ این موافقت، نادر و رضاقلی با خواهرانِ تهماسب ازدواج کردند. نادر اعلام کرد ابتدا دشمنانِ تهماسب را از میان می‌بَرد و سپس به خراسان بازمی‌گردد. در ۳ جمادی‌الثانی ۱۱۴۲ ه‍.ق/۲۴ دسامبر ۱۷۲۹ م، نادر با سپاهی ۲۰٬۰۰۰ یا ۲۵۰۰۰ نفری به شیراز لشکر کشید. در زرقان واقع در شمالِ شیراز نبردی درگرفت و افغان‌ها شکست خوردند و اسیر شدند و اشرف نیز به شیراز گریخت. اشرف ابتدا تلاش کرد با فرستادنِ شاهزادگان صفوی نزد نادر، با وی مذاکره کند، اما پس از آن از راهِ لار به ولایتِ قندهار فرار کرد. نادر به تعقیب اشرف تا آن سوی رودخانه پرداخت اما نتوانست به او دست یابد و به شیراز بازگشت. اشرف توانست خود را به ولایت قندهار برساند اما به‌خاطر هراس از حسین سلطان غل‌زایی، برادرِ محمود افغان، از ورود به شهر قندهار پرهیز کرد، اما به‌نظر می‌رسد توسط حسین سلطان، رقیبِ غل‌زایی کشته شد.