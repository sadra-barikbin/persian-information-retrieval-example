میرانشاه و پسرش ابابکر در دیار بکر و عراق عرب حکومت داشتند. عمر، پسر دیگر میرانشاه، حاکم آذربایجان و عراق عجم بود. پیرمحمد و رستم و اسکندر (پسران عمرشیخ)، به ترتیب فارس، اصفهان و همدان را تحت فرمان داشتند. هریک از آنان می‌کوشیدند تا با کمک امیران و لشکریان، هر چه زودتر سمرقند، تختگاه تیمور، را فتح کنند.

پیرمحمد که تیمور وصیت کرده بود جانشینش باشد در قندهار بود و نتوانست به‌موقع به سمرقند برسد. برخی از امیران تیمور، به بهانهٔ عملی کردن نقشهٔ لشکرکشی تیمور به چین، خلیل سلطان پسر میرانشاه را که در تاشکند بود، بر تخت نشاندند. اما خلیل سلطان با مخالفت سایر امیرانِ قدرتمند تیمور، از جمله امیرشاه ملک و امیرشیخ نورالدین و دیگر مدعیان حکومت روبرو شد. نخستین فرد از خاندان تیمور که مخالفت جدّی خود را با او آشکار کرد، سلطان حسین، نبیرهٔ دختری تیمور، والی ماورای سیحون بود اما نتوانست حمایت لشکریان را جلب کند و ناگزیر به شاهرخ پیوست و سپس در هرات به دستور او به قتل رسید. شاهرخ در هرات خود را وارث تخت پدر نامید و به سبب اقتدار و کفایتش توانست تا اندازه‌ای بر دیگر مدعیان چیره شود. پیرمحمد در شیراز بر خلاف برادرانش، حمایتش را از شاهرخ که ناپدری‌اش نیز بود، اعلام کرد.

در همین زمان درگیری و کشمکش میان مدعیان حکومت، یعنی پسران عمرشیخ (رستم، اسکندر، پیرمحمد و بایقَرا) و پسران میرانشاه (عمر و ابابکر و خلیل سلطان) آغاز شد. شاهرخ با اینکه بسیاری از امیران، همچون امیرشاه ملک و حاکمان محلی، از او حمایت می‌کردند از درگیری مستقیم با افراد خاندانش اجتناب کرد و به سروسامان دادن هرات مشغول شد.

از طرفی در تبریز، اصفهان، شیراز، کرمان و سبزوار به سبب بی‌کفایتی خلیل سلطان و درگیری مدعیان جانشینی، آشوب شده بود. خلیل سلطان پس از چهار سال حکومت در سمرقند و از بین بردن خزاین تیمور، گرفتار خدایداد حسینی، والی ماورای سیحون شد. شاهرخ در ۸۱۱ ه‍.ق به ماوراءالنهر لشکر کشید، خدایداد را کشت و خلیل سلطان را پس از رهایی به ری فرستاد و سمرقند را به اُلُغ‌بیگ داد.